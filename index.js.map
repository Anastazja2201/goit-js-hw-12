{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49358433-5727c4bf05d17bed3943eaf07';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nexport const fetchImages = async (searchQuery, page = 1) => {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: PER_PAGE,\n        page,\n      },\n    });\n    totalHits = response.data.totalHits;\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    return { hits: [], totalHits: 0 };\n  }\n};\n\nexport const loadMoreImages = async () => {\n  if (!currentQuery) return { hits: [] };\n  if (currentPage * PER_PAGE >= totalHits) {\n    return { hits: [] };\n  }\n  currentPage += 1;\n  return fetchImages(currentQuery, currentPage);\n};\n\nexport const resetPagination = () => {\n  currentPage = 1;\n};\n\nexport const setQuery = query => {\n  if (currentQuery !== query) {\n    currentQuery = query;\n    resetPagination();\n  }\n};\n\nexport const getCurrentPage = () => currentPage;\nexport const getPerPage = () => PER_PAGE;\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionSelector: 'img',\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport const renderGallery = images => {\n  const markup = images\n    .map(\n      image => `\n  <li class=\"gallery-item\">\n       <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"gallery-image\" />\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes:</b> ${image.likes}</p>\n          <p class=\"info-item\"><b>Views:</b> ${image.views}</p>\n          <p class=\"info-item\"><b>Comments:</b> ${image.comments}</p>\n          <p class=\"info-item\"><b>Downloads:</b> ${image.downloads}</p>\n        </div>\n      </a>\n    </li>\n  `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n};\n\nexport const showLoader = () => {\n  document.querySelector('.loader').style.display = 'block';\n};\n\nexport const hideLoader = () => {\n  document.querySelector('.loader').style.display = 'none';\n};\n\nexport const clearGallery = () => {\n  gallery.innerHTML = '';\n};\n\nexport const showLoadMoreButton = () => {\n  document.querySelector('.load-more').classList.remove('hidden');\n};\n\nexport const hideLoadMoreButton = () => {\n  document.querySelector('.load-more').classList.add('hidden');\n};\n\nexport const scrollPageAfterLoad = () => {\n  const galleryItem = document.querySelector('.gallery-item:last-child');\n  if (!galleryItem) return;\n\n  const itemHeight = galleryItem.getBoundingClientRect().height;\n  window.scrollBy({\n    top: itemHeight * 2,\n    behavior: 'smooth',\n  });\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n  fetchImages,\n  setQuery,\n  resetPagination,\n  loadMoreImages,\n  getCurrentPage,\n  getPerPage,\n} from './js/pixabay-api.js';\n\nimport {\n  renderGallery,\n  showLoader,\n  hideLoader,\n  clearGallery,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  scrollPageAfterLoad,\n} from './js/render-functions.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const form = document.querySelector('.form');\n  const input = document.querySelector('input[name=\"search-text\"]');\n  const loadMoreBtn = document.querySelector('.load-more');\n\n  hideLoader();\n  hideLoadMoreButton();\n\n  form.addEventListener('submit', async event => {\n    event.preventDefault();\n\n    const searchQuery = input.value.trim();\n\n    if (searchQuery === '') {\n      iziToast.error({\n        message: 'Please enter a search term!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    setQuery(searchQuery);\n    resetPagination();\n    clearGallery();\n    hideLoadMoreButton();\n    showLoader();\n\n    try {\n      const { hits, totalHits } = await fetchImages(searchQuery);\n      const perPage = getPerPage();\n\n      if (hits.length === 0) {\n        iziToast.warning({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n            position: 'topRight',\n          });\n      } else {\n        renderGallery(hits);\n\n        if (perPage * getCurrentPage() < totalHits) {\n          showLoadMoreButton();\n        }\n      }\n    } catch (error) {\n      iziToast.error({\n        message:\n          'An error occurred while fetching images. Please try again later.',\n          position: 'topRight',\n        });\n      console.error('Error fetching images:', error);\n    } finally {\n      hideLoader();\n    }\n  });\n  loadMoreBtn.addEventListener('click', async () => {\n    showLoader();\n\n    try {\n      const { hits, totalHits } = await loadMoreImages();\n      const perPage = getPerPage();\n\n      if (hits.length > 0) {\n        renderGallery(hits);\n        scrollPageAfterLoad();\n      }\n\n       if (perPage * getCurrentPage() >= totalHits) {\n        hideLoadMoreButton();\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } catch (error) {\n      iziToast.error({\n        message: 'Error loading more images.',\n        position: 'topRight',\n      });\n      console.error(error);\n    } finally {\n      hideLoader();\n    }\n  });\n});\n"],"names":["API_KEY","BASE_URL","PER_PAGE","currentPage","currentQuery","totalHits","fetchImages","searchQuery","page","response","axios","error","loadMoreImages","resetPagination","setQuery","query","getCurrentPage","getPerPage","gallery","lightbox","SimpleLightbox","renderGallery","images","markup","image","showLoader","hideLoader","clearGallery","showLoadMoreButton","hideLoadMoreButton","scrollPageAfterLoad","galleryItem","itemHeight","form","input","loadMoreBtn","event","iziToast","hits","perPage"],"mappings":"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"}